<div class="sport-parse-eesl">
  <app-entity-header
    [title]="sport()?.title || 'Parse EESL Season'"
    [showEdit]="false"
    [showDelete]="false"
    [showGear]="false"
    (navigateBack)="navigateBack()"
  />

  <div class="sport-parse-eesl__content">
    <div class="sport-parse-eesl__form-card">
      <div class="sport-parse-eesl__info">
        <p>Select a season year to parse and automatically create tournaments in database.</p>
      </div>

      <div class="sport-parse-eesl__field">
        <label class="sport-parse-eesl__label">Select EESL season year</label>
        <tui-textfield tuiChevron>
          <input
            placeholder="Select a season"
            tuiSelect
            [ngModel]="eeslSeasonYear()"
            (ngModelChange)="onSeasonChange($event)"
          />
          <tui-data-list *tuiTextfieldDropdown>
            @for (year of availableYears(); track year) {
              <button
                new
                tuiOption
                type="button"
                [value]="year"
              >
                {{ year }}
              </button>
            }
          </tui-data-list>
        </tui-textfield>
      </div>

      <div class="sport-parse-eesl__actions">
        <button
          tuiButton
          type="button"
          appearance="primary"
          [disabled]="isParsing() || !eeslSeasonYear()"
          (click)="parseSeason()"
        >
          @if (isParsing()) {
            Parsing and Creating...
          } @else {
            Parse and Create
          }
        </button>
      </div>
    </div>

    @if (parsedTournaments().length > 0) {
      <div class="sport-parse-eesl__results">
        <h2 class="sport-parse-eesl__results-title">Tournaments Created</h2>

        @for (tournament of parsedTournaments(); track tournament.id ?? $index) {
          <div class="sport-parse-eesl__tournament-card">
            <div class="sport-parse-eesl__tournament-content">
              <tui-icon icon="@tui.trophy" class="sport-parse-eesl__tournament-icon" />
              <div class="sport-parse-eesl__tournament-info">
                <div class="sport-parse-eesl__tournament-title">{{ tournament.title }}</div>
                <div class="sport-parse-eesl__tournament-id">EESL ID: {{ tournament.tournament_eesl_id ?? 'N/A' }}</div>
                @if (tournament.description) {
                  <div class="sport-parse-eesl__tournament-description">{{ tournament.description }}</div>
                }
              </div>
            </div>
          </div>
        }
      </div>
    }
  </div>
</div>
