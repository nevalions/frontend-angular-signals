<div class="sport-parse-eesl">
  <div class="sport-parse-eesl__header">
    <button class="sport-parse-eesl__back-btn" (click)="navigateBack()">
      â† Back
    </button>
    <h1 class="sport-parse-eesl__title">Parse EESL Season</h1>
    <button class="sport-parse-eesl__cancel-btn" (click)="navigateBack()">
      Cancel
    </button>
  </div>

  <div class="sport-parse-eesl__content">
    <div class="sport-parse-eesl__info">
      <p>Select the EESL season year to parse and automatically create tournaments in the database.</p>
    </div>

    <div class="sport-parse-eesl__form">
      <div class="sport-parse-eesl__field">
        <label class="sport-parse-eesl__label" for="eesl-season-year">EESL Season Year</label>
        <select
          id="eesl-season-year"
          class="sport-parse-eesl__select"
          [(ngModel)]="eeslSeasonYear"
        >
          <option value="">Select a season...</option>
          @for (year of availableYears(); track year) {
            <option [value]="year">{{ year }}</option>
          }
        </select>
      </div>

      <div class="sport-parse-eesl__actions">
        <button
          class="sport-parse-eesl__btn sport-parse-eesl__btn--primary"
          [disabled]="isParsing() || !eeslSeasonYear()"
          (click)="parseSeason()"
        >
          @if (isParsing()) {
            <span class="sport-parse-eesl__btn-icon">ğŸ”</span> Parsing and Creating...
          } @else {
            <span class="sport-parse-eesl__btn-icon">ğŸ“¥</span> Parse and Create
          }
        </button>
      </div>
    </div>

    @if (parsedTournaments().length > 0) {
      <div class="sport-parse-eesl__results">
        <h2 class="sport-parse-eesl__results-title">Tournaments Created</h2>

        @for (tournament of parsedTournaments(); track tournament.id ?? $index) {
          <div class="sport-parse-eesl__tournament-card">
            <div class="sport-parse-eesl__tournament-content">
              <div class="sport-parse-eesl__tournament-icon">ğŸ†</div>
              <div class="sport-parse-eesl__tournament-info">
                <div class="sport-parse-eesl__tournament-title">{{ tournament.title }}</div>
                <div class="sport-parse-eesl__tournament-id">EESL ID: {{ tournament.tournament_eesl_id ?? 'N/A' }}</div>
                @if (tournament.description) {
                  <div class="sport-parse-eesl__tournament-description">{{ tournament.description }}</div>
                }
              </div>
            </div>
          </div>
        }
      </div>
    }
  </div>

  @if (showSuccessDialog()) {
    <div class="sport-parse-eesl__dialog-overlay" (click)="closeSuccessDialog()">
      <div class="sport-parse-eesl__dialog" (click)="$event.stopPropagation()">
        <div class="sport-parse-eesl__dialog-icon">âœ“</div>
        <h3 class="sport-parse-eesl__dialog-title">Success!</h3>
        <p class="sport-parse-eesl__dialog-message">{{ successMessage() }}</p>
        <button class="sport-parse-eesl__dialog-btn" (click)="closeSuccessDialog()">
          OK
        </button>
      </div>
    </div>
  }
</div>
