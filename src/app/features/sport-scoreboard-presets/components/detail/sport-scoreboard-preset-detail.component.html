@if (loading()) {
  <div class="preset-detail__loading">
    <tui-loader size="l" />
  </div>
} @else if (!preset()) {
  <div class="preset-detail__not-found">Preset not found</div>
} @else {
  <div class="preset-detail">
    <app-entity-header
      [title]="preset()!.title"
      [showEdit]="true"
      [showDelete]="true"
      [showGear]="true"
      (edit)="onEdit()"
      (delete)="onDelete()"
      (navigateBack)="navigateBack()"
    />

    <div class="preset-detail__content">
      <div class="preset-detail__overview">
        <div class="preset-detail__overview-item">
          <span class="preset-detail__overview-title">Period Mode</span>
          <tui-badge appearance="neutral">{{ periodModeLabel() }}</tui-badge>
        </div>
        <div class="preset-detail__overview-item">
          <span class="preset-detail__overview-title">Timeouts</span>
          <tui-badge [appearance]="preset()!.has_timeouts ? 'success' : 'error'">
            {{ preset()!.has_timeouts ? 'Enabled' : 'Disabled' }}
          </tui-badge>
        </div>
        <div class="preset-detail__overview-item">
          <span class="preset-detail__overview-title">Playclock</span>
          <tui-badge [appearance]="preset()!.has_playclock ? 'success' : 'error'">
            {{ preset()!.has_playclock ? 'Enabled' : 'Disabled' }}
          </tui-badge>
        </div>
      </div>

      <div class="preset-detail__grid">
      <div class="preset-detail__section">
        <h3 class="preset-detail__section-title">Gameclock Configuration</h3>
        <div class="preset-detail__fields">
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Max Gameclock:</span>
            <span class="preset-detail__field-value">{{ preset()!.gameclock_max ?? 'N/A' }} seconds</span>
          </div>
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Initial Time Mode:</span>
            <tui-badge appearance="neutral">{{ initialTimeModeLabel() }}</tui-badge>
          </div>
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Period Clock Behavior:</span>
            <tui-badge appearance="neutral">{{ periodClockVariantLabel() }}</tui-badge>
          </div>
          @if (preset()!.initial_time_mode === 'min') {
            <div class="preset-detail__field">
              <span class="preset-detail__field-label">Initial Min Time:</span>
              <span class="preset-detail__field-value">{{ preset()!.initial_time_min_seconds ?? 'N/A' }} seconds</span>
            </div>
          }
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Direction:</span>
            <tui-badge appearance="neutral">{{ directionLabel() }}</tui-badge>
          </div>
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">On Stop Behavior:</span>
            <tui-badge appearance="neutral">{{ onStopBehaviorLabel() }}</tui-badge>
          </div>
        </div>
      </div>

      <div class="preset-detail__section">
        <h3 class="preset-detail__section-title">Scoreboard Configuration</h3>
        <div class="preset-detail__fields">
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Show Quarter:</span>
            <tui-badge [appearance]="preset()!.is_qtr ? 'success' : 'error'">
              {{ preset()!.is_qtr ? 'Yes' : 'No' }}
            </tui-badge>
          </div>
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Show Time:</span>
            <tui-badge [appearance]="preset()!.is_time ? 'success' : 'error'">
              {{ preset()!.is_time ? 'Yes' : 'No' }}
            </tui-badge>
          </div>
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Show Playclock:</span>
            <tui-badge [appearance]="preset()!.is_playclock ? 'success' : 'error'">
              {{ preset()!.is_playclock ? 'Yes' : 'No' }}
            </tui-badge>
          </div>
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Show Down & Distance:</span>
            <tui-badge [appearance]="preset()!.is_downdistance ? 'success' : 'error'">
              {{ preset()!.is_downdistance ? 'Yes' : 'No' }}
            </tui-badge>
          </div>
        </div>
      </div>

      <div class="preset-detail__section">
        <h3 class="preset-detail__section-title">Preset Capabilities</h3>
        <div class="preset-detail__fields">
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Has Timeouts:</span>
            <tui-badge [appearance]="preset()!.has_timeouts ? 'success' : 'error'">
              {{ preset()!.has_timeouts ? 'Yes' : 'No' }}
            </tui-badge>
          </div>
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Has Playclock:</span>
            <tui-badge [appearance]="preset()!.has_playclock ? 'success' : 'error'">
              {{ preset()!.has_playclock ? 'Yes' : 'No' }}
            </tui-badge>
          </div>
        </div>
      </div>

      <div class="preset-detail__section">
        <h3 class="preset-detail__section-title">Period Configuration</h3>
        <div class="preset-detail__fields">
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Period Mode:</span>
            <tui-badge appearance="neutral">{{ periodModeLabel() }}</tui-badge>
          </div>
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Period Count:</span>
            <span class="preset-detail__field-value">{{ preset()!.period_count }}</span>
          </div>
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Custom Period Labels:</span>
            @if (customPeriodLabels().length > 0) {
              <div class="preset-detail__labels">
                @for (label of customPeriodLabels(); track label) {
                  <tui-badge appearance="neutral">{{ label }}</tui-badge>
                }
              </div>
            } @else {
              <span class="preset-detail__field-value">N/A</span>
            }
          </div>
        </div>
      </div>

      <div class="preset-detail__section">
        <h3 class="preset-detail__section-title">Playclock Configuration</h3>
        <div class="preset-detail__fields">
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Default Playclock:</span>
            <span class="preset-detail__field-value">{{ preset()!.default_playclock_seconds ?? 'N/A' }} seconds</span>
          </div>
        </div>
      </div>

      <div class="preset-detail__section">
        <h3 class="preset-detail__section-title">Quick Score Deltas</h3>
        <div class="preset-detail__fields">
          <div class="preset-detail__field">
            <span class="preset-detail__field-label">Value-only buttons:</span>
            <div class="preset-detail__labels">
              @for (delta of quickScoreDeltas(); track $index) {
                <tui-badge appearance="neutral">{{ delta }}</tui-badge>
              }
            </div>
          </div>
        </div>
      </div>
      </div>

      <div class="preset-detail__section">
        <h3 class="preset-detail__section-title">Sports Using This Preset</h3>
        @if (sportsLoading()) {
          <div class="preset-detail__sports-loading">
            <tui-loader size="m" />
          </div>
        } @else if (sports().length === 0) {
          <div class="preset-detail__no-sports">No sports are using this preset</div>
        } @else {
          <div class="preset-detail__sports">
            @for (sport of sports(); track sport.id) {
              <a
                class="preset-detail__sport-card"
                tuiAppearance="floating"
                tuiCardLarge
                tuiCell="l"
                [routerLink]="['/sports', sport.id]"
              >
                <div class="preset-detail__sport-name">{{ sport.title | uppercase }}</div>
              </a>
            }
          </div>
        }
      </div>
    </div>
  </div>
}
