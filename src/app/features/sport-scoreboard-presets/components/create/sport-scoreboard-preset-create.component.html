<div class="preset-create">
  <header class="preset-create__header">
    <h1 class="preset-create__title">Create New Preset</h1>
    <div class="preset-create__actions">
      <button tuiButton type="button" appearance="flat" (click)="navigateToList()">
        Cancel
      </button>
      <button tuiButton type="button" appearance="primary" (click)="onSubmit()" [disabled]="presetForm.invalid || customPeriodLabelsInvalid() || customMinTimeModeInvalid()">
        Create Preset
      </button>
    </div>
  </header>

  <form [formGroup]="presetForm" class="preset-create__form">
    <div class="preset-create__section">
      <h3 class="preset-create__section-title">Basic Information</h3>
      <div class="preset-create__field">
        <label class="preset-create__label" for="title">Title *</label>
        <input
          id="title"
          type="text"
          placeholder="Enter preset title"
          formControlName="title"
          class="preset-create__input"
        />
      </div>
    </div>

    <div class="preset-create__section">
      <h3 class="preset-create__section-title">Gameclock Configuration</h3>
      <div class="preset-create__field">
        <label class="preset-create__label" for="gameclock_max">Max Gameclock (seconds)</label>
        <input
          id="gameclock_max"
          type="number"
          placeholder="720"
          formControlName="gameclock_max"
          class="preset-create__input"
        />
      </div>
      <div class="preset-create__field">
        <label class="preset-create__label" for="initial_time_mode">Initial Time Mode</label>
        <select
          id="initial_time_mode"
          formControlName="initial_time_mode"
          class="preset-create__select"
        >
          @for (option of initialTimeModeOptions; track option.value) {
            <option [value]="option.value">{{ option.label }}</option>
          }
        </select>
      </div>
      @if (isCustomMinTimeMode()) {
        <div class="preset-create__field">
          <label class="preset-create__label" for="initial_time_min_seconds">Min Gameclock (seconds) *</label>
          <input
            id="initial_time_min_seconds"
            type="number"
            placeholder="0"
            formControlName="initial_time_min_seconds"
            class="preset-create__input"
          />
          @if (customMinTimeModeInvalid()) {
            <p class="preset-create__error">Min gameclock is required and must be >= 0 when Initial Time Mode is Custom Min.</p>
          }
        </div>
      }
      <div class="preset-create__field">
        <label class="preset-create__label" for="direction">Clock Direction</label>
        <select
          id="direction"
          formControlName="direction"
          class="preset-create__select"
        >
          @for (option of directionOptions; track option.value) {
            <option [value]="option.value">{{ option.label }}</option>
          }
        </select>
      </div>
      <div class="preset-create__field">
        <label class="preset-create__label" for="on_stop_behavior">On Stop Behavior</label>
        <select
          id="on_stop_behavior"
          formControlName="on_stop_behavior"
          class="preset-create__select"
        >
          @for (option of onStopBehaviorOptions; track option.value) {
            <option [value]="option.value">{{ option.label }}</option>
          }
        </select>
      </div>
    </div>

    <div class="preset-create__section">
      <h3 class="preset-create__section-title">Scoreboard Configuration</h3>
      <div class="preset-create__checkboxes">
        <label class="preset-create__checkbox">
          <input
            type="checkbox"
            tuiCheckbox
            formControlName="is_qtr"
          />
          <span>Show Quarter Indicator</span>
        </label>
        <label class="preset-create__checkbox">
          <input
            type="checkbox"
            tuiCheckbox
            formControlName="is_time"
          />
          <span>Show Time Display</span>
        </label>
        <label class="preset-create__checkbox">
          <input
            type="checkbox"
            tuiCheckbox
            formControlName="is_playclock"
          />
          <span>Show Playclock</span>
        </label>
        <label class="preset-create__checkbox">
          <input
            type="checkbox"
            tuiCheckbox
            formControlName="is_downdistance"
          />
          <span>Show Down & Distance</span>
        </label>
      </div>
    </div>

    <div class="preset-create__section">
      <h3 class="preset-create__section-title">Capabilities</h3>
      <div class="preset-create__checkboxes">
        <label class="preset-create__checkbox">
          <input
            type="checkbox"
            tuiCheckbox
            formControlName="has_timeouts"
          />
          <span>Enable Timeouts</span>
        </label>
        <label class="preset-create__checkbox">
          <input
            type="checkbox"
            tuiCheckbox
            formControlName="has_playclock"
          />
          <span>Enable Playclock</span>
        </label>
      </div>
    </div>

    <div class="preset-create__section">
      <h3 class="preset-create__section-title">Period Configuration</h3>
      <div class="preset-create__field">
        <label class="preset-create__label" for="period_mode">Period Mode</label>
        <select
          id="period_mode"
          formControlName="period_mode"
          class="preset-create__select"
        >
          @for (option of periodModeOptions; track option.value) {
            <option [value]="option.value">{{ option.label }}</option>
          }
        </select>
      </div>
      <div class="preset-create__field">
        <label class="preset-create__label" for="period_count">Period Count</label>
        <input
          id="period_count"
          type="number"
          min="1"
          max="99"
          placeholder="4"
          formControlName="period_count"
          class="preset-create__input"
        />
      </div>

      @if (isCustomPeriodMode()) {
        <div class="preset-create__field">
          <label class="preset-create__label" for="period_labels_input">Custom Period Labels</label>
          <input
            id="period_labels_input"
            type="text"
            placeholder="period.leg_1, period.leg_2"
            formControlName="period_labels_input"
            class="preset-create__input"
          />
          <p class="preset-create__hint">Comma separated machine labels (lowercase letters/numbers with '.', '_' or '-').</p>
          @if (customPeriodLabelsInvalid()) {
            <p class="preset-create__error">Custom labels contain invalid keys.</p>
          }
        </div>
      }
    </div>

    <div class="preset-create__section">
      <h3 class="preset-create__section-title">Playclock Configuration</h3>
      <div class="preset-create__field">
        <label class="preset-create__label" for="default_playclock_seconds">Default Playclock (seconds)</label>
        <input
          id="default_playclock_seconds"
          type="number"
          placeholder="40"
          formControlName="default_playclock_seconds"
          class="preset-create__input"
        />
      </div>
    </div>
  </form>
</div>
