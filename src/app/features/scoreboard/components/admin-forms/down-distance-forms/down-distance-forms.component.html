<app-collapsible-section title="Down & Distance" sectionKey="scoreboard-down-distance">
  <ng-template>
    <div class="down-distance-forms">
      <!-- Down & Distance Panel -->
      <div class="down-distance-panel">
        <!-- Current Down & Distance Display -->
        <div class="current-values">
          <span class="values">
            @if (currentDown()) {
              {{ currentDown() }} & {{ currentDistance() }}
            } @else {
              {{ currentDistance() }}
            }
          </span>
        </div>

        <!-- Down Selection -->
        <div class="form-section">
          <label class="section-label">Down</label>
          <div class="down-buttons">
            @for (option of downOptions; track option.value) {
              <button
                tuiButton
                type="button"
                [appearance]="isDownSelected(option.value) ? 'primary' : 'secondary'"
                size="m"
                (click)="onDownSelect(option.value)"
              >
                {{ option.label }}
              </button>
            }

            <!-- Flag Toggle Button -->
            <button
              tuiButton
              type="button"
              [appearance]="isFlagActive() ? 'accent' : 'outline'"
              size="m"
              class="flag-toggle-button"
              [class.flag-active]="isFlagActive()"
              (click)="onFlagToggle()"
            >
              <span class="flag-icon">ðŸš©</span>
            </button>
          </div>
        </div>

        <!-- Distance Select & Save Row -->
        <div class="distance-save-row">
          <div class="distance-select-wrapper">
            <tui-textfield tuiChevron [tuiTextfieldCleaner]="false">
              <label tuiLabel>Distance</label>
              <input
                tuiSelect
                [ngModel]="pendingDistance()"
                (ngModelChange)="pendingDistance.set($event)"
                placeholder="Select distance"
              />
              <tui-data-list-wrapper *tuiTextfieldDropdown new [items]="distanceOptions" />
            </tui-textfield>
          </div>

          <!-- Save Button -->
          <button
            tuiButton
            type="button"
            appearance="primary"
            size="l"
            class="save-button"
            [disabled]="!hasChanges()"
            (click)="onSave()"
          >
            Save
          </button>
        </div>

        <!-- Quick Distance Buttons -->
        <div class="distance-presets">
          <button
            tuiButton
            type="button"
            appearance="outline"
            size="s"
            (click)="pendingDistance.set('INCH')"
          >
            INCH
          </button>
          <button
            tuiButton
            type="button"
            appearance="outline"
            size="s"
            (click)="pendingDistance.set('GOAL')"
          >
            GOAL
          </button>
          <button
            tuiButton
            type="button"
            appearance="outline"
            size="s"
            (click)="pendingDistance.set('10')"
          >
            10
          </button>
        </div>

        <!-- Special Game States -->
        <div class="form-section">
          <label class="section-label">Special States</label>
          <div class="special-state-buttons">
            <button
              tuiButton
              type="button"
              [appearance]="isSpecialStateSelected('PAT 1') ? 'primary' : 'secondary'"
              size="m"
              (click)="onSpecialStateSelect('PAT 1')"
            >
              PAT 1
            </button>
            <button
              tuiButton
              type="button"
              [appearance]="isSpecialStateSelected('PAT 2') ? 'primary' : 'secondary'"
              size="m"
              (click)="onSpecialStateSelect('PAT 2')"
            >
              PAT 2
            </button>
            <button
              tuiButton
              type="button"
              [appearance]="isSpecialStateSelected('FG') ? 'primary' : 'secondary'"
              size="m"
              (click)="onSpecialStateSelect('FG')"
            >
              FG
            </button>
            <button
              tuiButton
              type="button"
              [appearance]="isSpecialStateSelected('KICK OFF') ? 'primary' : 'secondary'"
              size="m"
              (click)="onSpecialStateSelect('KICK OFF')"
            >
              KICK OFF
            </button>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</app-collapsible-section>
