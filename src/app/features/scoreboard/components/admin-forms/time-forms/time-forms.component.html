<app-collapsible-section title="Time Controls" sectionKey="scoreboard-time">
  <ng-template>
    <div class="time-forms">
      <!-- Game Clock Section -->
      <div class="time-section game-clock-section">
        <h4 class="section-title">Game Clock</h4>

        <!-- Quarter Length at top -->
        <div class="max-time-setting">
          <span class="setting-label">Quarter Length (min)</span>
          <div class="max-time-row">
            <app-input-number-with-buttons
              [value]="currentMaxMinutes()"
              [min]="1"
              [max]="20"
              size="m"
              layout="compact"
              [disabled]="inputsDisabled()"
              (valueChange)="onMaxMinutesChange($event)"
            />
            <button
              tuiButton
              type="button"
              appearance="primary"
              size="m"
              class="save-button"
              (click)="onSaveQuarterLength()"
              [disabled]="!gameClockReady() || inputsDisabled()"
            >
              Save
            </button>
          </div>
        </div>

        <div class="clock-display">
          <span class="clock-value">{{ gameClockDisplay() }}</span>
          <span class="clock-status" [class.running]="gameClockRunning()">
            {{ gameClockRunning() ? 'Running' : 'Stopped' }}
          </span>
        </div>

        <div class="clock-controls">
          @if (gameClockRunning()) {
            <button
              tuiButton
              type="button"
              appearance="primary"
              size="m"
              (click)="onGameClockPause()"
              [disabled]="!gameClockReady() || gameClockLocked()"
            >
              <tui-icon icon="@tui.pause" />
              Pause
            </button>
          } @else {
            <button
              tuiButton
              type="button"
              appearance="primary"
              size="m"
              (click)="onGameClockStart()"
              [disabled]="!gameClockReady() || gameClockLocked()"
            >
              <tui-icon icon="@tui.play" />
              Start
            </button>
          }

          <button
            tuiButton
            type="button"
            appearance="secondary"
            size="m"
            (click)="onGameClockReset()"
            [disabled]="!gameClockReady() || gameClockRunning() || gameClockLocked()"
          >
            <tui-icon icon="@tui.refresh-cw" />
            Reset
          </button>
        </div>

        <div class="manual-time-entry">
          <span class="setting-label">Set Time</span>
          <div class="time-inputs-compact">
            <div class="time-input-group">
              <span class="input-label">Min</span>
              <app-input-number-with-buttons
                [value]="manualMinutes()"
                [min]="0"
                [max]="99"
                size="m"
                layout="compact"
                [disabled]="inputsDisabled()"
                (valueChange)="onManualMinutesChange($event)"
              />
            </div>
            <div class="time-input-group">
              <span class="input-label">Sec</span>
              <app-input-number-with-buttons
                [value]="manualSeconds()"
                [min]="0"
                [max]="59"
                size="m"
                layout="compact"
                [disabled]="inputsDisabled()"
                (valueChange)="onManualSecondsChange($event)"
              />
            </div>
            <button
              tuiButton
              type="button"
              appearance="primary"
              size="m"
              class="save-button"
              (click)="onSetGameClock()"
              [disabled]="!gameClockReady() || inputsDisabled()"
            >
              Set
            </button>
          </div>
        </div>
      </div>

      <!-- Play Clock Section -->
      <div class="time-section play-clock-section">
        <h4 class="section-title">Play Clock</h4>

        <div class="clock-display play-clock-display" [class.warning]="playClockSeconds() <= 5">
          <span class="clock-value">{{ playClockSeconds() }}</span>
          <span class="clock-status" [class.running]="playClockRunning()">
            {{ playClockRunning() ? 'Running' : 'Stopped' }}
          </span>
        </div>

        <div class="play-clock-buttons">
          <button
            tuiButton
            type="button"
            appearance="primary"
            size="m"
            (click)="onPlayClockStart(40)"
            [disabled]="!playClockReady() || playClockRunning() || playClockLocked()"
          >
            40 sec
          </button>

          <button
            tuiButton
            type="button"
            appearance="primary"
            size="m"
            (click)="onPlayClockStart(25)"
            [disabled]="!playClockReady() || playClockRunning() || playClockLocked()"
          >
            25 sec
          </button>

          <button
            tuiButton
            type="button"
            appearance="secondary"
            size="m"
            (click)="onPlayClockReset()"
            [disabled]="!playClockReady() || playClockLocked()"
          >
            Reset
          </button>
        </div>
      </div>
    </div>
  </ng-template>
</app-collapsible-section>
