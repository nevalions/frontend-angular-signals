<div class="player-detail">
  @if (loading()) {
    <div class="player-detail__loading">Loading player...</div>
  } @else if (player()) {
    <app-entity-header
      [title]="playerName()"
      [showDelete]="!isInSportContext()"
      [customMenuItems]="customMenuItems()"
      (navigateBack)="navigateBack()"
      (customItemClick)="onCustomItemClick($event)"
    />

    <div class="player-detail__content">
      @if (careerByTeam().length > 0 || careerByTournament().length > 0) {
        <div class="player-detail__sections">
          <section class="player-detail__section">
            <h2 class="player-detail__section-title">Career by Team</h2>
            @if (careerByTeam().length > 0) {
              <div class="player-detail__career-list">
                @for (team of careerByTeam(); track team.teamTitle) {
                  <div class="player-detail__career-card">
                    <h3 class="player-detail__career-title">{{ team.teamTitle }}</h3>
                    <div class="player-detail__career-details">
                      @for (assignment of team.assignments; track assignment.id) {
                        <div class="player-detail__career-item">
                          @if (assignment.position_title) {
                            <span class="player-detail__position">{{ assignment.position_title }}</span>
                          }
                          @if (assignment.player_number) {
                            <span class="player-detail__number">#{{ assignment.player_number }}</span>
                          }
                        </div>
                      }
                    </div>
                  </div>
                }
              </div>
            } @else {
              <p class="player-detail__empty">No team assignments yet</p>
            }
          </section>

          <section class="player-detail__section">
            <h2 class="player-detail__section-title">Career by Tournament</h2>
            @if (careerByTournament().length > 0) {
              <div class="player-detail__career-list">
                @for (tournament of careerByTournament(); track tournament.tournamentId) {
                  <div class="player-detail__career-card">
                    <h3 class="player-detail__career-title">
                      Tournament ID: {{ tournament.tournamentId || 'N/A' }}
                    </h3>
                    <div class="player-detail__career-details">
                      @for (assignment of tournament.assignments; track assignment.id) {
                        <div class="player-detail__tournament-item">
                          <div>
                            <strong>Team:</strong> {{ assignment.team_title || 'N/A' }}
                          </div>
                          @if (assignment.position_title) {
                            <div>
                              <strong>Position:</strong> {{ assignment.position_title }}
                            </div>
                          }
                          @if (assignment.player_number) {
                            <div>
                              <strong>Number:</strong> {{ assignment.player_number }}
                            </div>
                          }
                        </div>
                      }
                    </div>
                  </div>
                }
              </div>
            } @else {
              <p class="player-detail__empty">No tournament assignments yet</p>
            }
          </section>
        </div>
      } @else {
        <div class="player-detail__empty-state">
          <p>This player has no team or tournament assignments yet.</p>
        </div>
      }
    </div>
  } @else if (error()) {
    <div class="player-detail__error">
      <p>Error loading player</p>
    </div>
  } @else {
    <div class="player-detail__not-found">Player not found</div>
  }
</div>
